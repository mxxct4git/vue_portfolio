---
title: 用户画像
date: 2021-12-01
summary: 企业级用户画像平台，提供统一的高性能数据服务与监控能力。
tags: [画像, 数据平台]
tech: [Spring Boot, Redis, ClickHouse, Flink, Kafka, Dubbo, Vue]
status: 已交付
cover: https://lf3-starry.byteimg.com/obj/starry/image/xeujaamdeoq_%E6%95%B0%E6%8D%AE%E8%B5%84%E4%BA%A7%E6%B2%89%E6%B7%80.png
order: 1
---

## 用户画像  

### 1. 背景  

在**社交**领域，我们的核心目标是通过准确匹配用户的**兴趣、性格与情感需求**，来**促进深层次的社交连接**。传统社交平台主要依赖**人口属性**（如年龄、性别）进行匹配，难以满足用户对**“精神共鸣”**的诉求。为此，我们设计了**细粒度的用户画像系统**，目标包括：  

- 通过更深入地理解用户偏好，**提升匹配准确率与留存**  
- **优化内容推荐**，提升互动与个性化体验  
- **释放商业价值**，如**定向广告、增值服务、会员变现**  

### 2. 角色与职责  

作为**项目负责人**，我主要负责：  

1. **架构与研发**用户画像系统的数据基础设施  
2. 提供**统一的高性能数据查询服务**，支撑多部门业务  
3. 建立**端到端监控体系**，确保**准确性、效率与高可用**  

### 3. 标签设计  

#### 3.1 按类型分类  

- **基础标签**  
  - 静态属性：**年龄、性别、位置**等  

- **行为标签**  
  - 来源于用户行为：**登录频次（最近 X 天）、最近群聊互动时间**等  

- **兴趣标签**  
  - 基于**人口属性**与**行为模式**（如浏览、购买记录）**算法生成**，为**个性化与业务决策**提供依据  

#### 3.2 按时效分类  

- **离线标签**  
  - **T+1 延迟**：每日从业务库抽取数据，在 **Hive** 中批处理，写入 **ClickHouse** 支撑人群圈选与历史查询  

- **实时标签**  
  - **T+1min 延迟**（随上报频率变化）：  
    - **Flink + Kafka** 处理实时事件  
    - 数据存入 **Redis** 以便快速检索  
    - **统一数据服务**保证 **10–50ms** 查询响应  

### 4. 系统架构  

| 组件 | 技术栈 |
|-----------|------------------|
| **前端** | JavaScript, Vue |
| **后端** | Java, Spring Boot |
| **数据处理** | Java, Flink, Spark |
| **存储** | MySQL, Hive, ClickHouse, Redis |
| **分布式服务** | Apache Dubbo |
| **配置管理** | Apache Apollo |

### 5. 项目里程碑  

- **06/2021 – 09/2021**  
  1. 开展**可行性研究**，分析**行业领先方案**（如阿里云）  
  2. 设计**平台架构**并确定**实施路线图**  
  3. 协调**跨团队协作**，发布 **1.0** 版本  

- **09/2021 – 12/2021**  
  1. 上线**统一数据查询服务**，达成 **10–50ms** 响应  
  2. 开发**高级人群圈选**能力，实现**精准用户触达**  

- **01/2022 – 03/2022**  
  1. 建立**端到端监控**，确保 **99.99%** 可用性、准确性与及时性  
  2. 引入**二级缓存**，降低 **Redis** 负载，**响应速度提升 30%**  
  3. 优化 **Redis** 存储效率，对长文本进行压缩，**存储成本降低 20%**  

### 6. 关键挑战  

1. 从零打造**企业级用户画像系统**  
2. 将查询服务从 **Kubernetes (K8s)** 迁移到 **Dubbo**，在服务重启期间保持**高稳定性**  
3. 建立**平台级监控框架**，保障 SLA 并**实时发现异常**  

### 7. 关键成果  

1. **季度平均新增 600+ 人群**，Q2 **计算任务 9000+ 次**  
2. 支撑**日常 40+ 业务策略**，覆盖**50%** 的业务场景  
3. **广告日查询量 14 亿+**，其他业务 **8 亿+**  

### 8. 未来规划  

为对齐 **火山引擎**的用户行为分析平台，下一步：  

- **将数据从 ClickHouse 迁移到 StarRocks**，提升复杂查询的**多表 JOIN 效率**  
- 利用 **Flink** 进行**用户行为实时采集**，实现**属性、行为与策略**的**统一查询体验**  

### 9. 系统架构图  
![Portrait Image](/assets/portrait.png)